<style>
    ul.dropdown-menu.pull-right {
        left: 0px !important;
    }
    button.btn.blue.dropdown-toggle {
        width: 86% !important
    }

    .tooltip {
        position: relative;
        display: inline-block;
        z-index: 99999 !important;
        opacity: unset !important;
    }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 999999;
            margin-left: -160px;
            opacity: 0;
            transition: opacity 0.3s;
            top: 17px !important;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    .class-service {
        position: absolute;
        margin-top: -12px !important;
    }
    .category-title {
        font-size: 13px;
        font-weight: bold;
        margin-top: 10px;
        color: #f9c629;
    }
</style>
<div class="row">
    <div class="col-md-12">
        <div class="clearfix page-controls">
            <div class="dataTables_length pull-left m-t-15 showing-record search-single" id="sample_1_length">
                <label>
                    Show
                    <select name="sample_1_length" aria-controls="sample_1" class="form-control input-sm input-inline"
                            ng-model="vm.query.pageSize" ng-change="vm.getBatchList();"
                            ng-options="option.value as option.display for option in vm.pagingOptions">
                        <option selected disabled hidden style='display: none' value=''></option>
                    </select> records
                </label>
            </div>
            <div class="pull-right search-btn-wrap">
                <div class="search-box">
                    <div class="pull-left search-single" style="margin-right: 50px;">
                        <button id="sample_editable_1_new" class="tooltip" style="background: none; border: none; z-index: 11 !important; cursor: auto;">
                            <span style="margin-left: -19px" class="class-service"><b>Instructions</b></span>
                            <span>
                                <i class="fa fa-info-circle" aria-hidden="true" style="color:#26327e !important;font-size: 35px;margin-top: 12px;"></i>
                            </span>
                            <span class="tooltiptext" style="top: 38px !important; color: white !important; background-color: #26327e !important; width: 300px !important; padding: 10px !important;">
                                <p>
                                    Steps to Upload Sales Data File:
                                </p>
                                <p style="text-align:left !important">
                                    1. Download the sample file using the “Download Sample File” button.
                                </p>
                                <p style="text-align:left !important">
                                    2. Enter your sales data into the file.
                                </p>
                                <p style="text-align:left !important">
                                    3. In the Class column, add the Marketing Class and Service Type in the format:<br />
                                    <b>Marketing Class:Service Type</b>
                                </p>
                                <p style="text-align:left !important">
                                    4. Refer to the (i) icon under the Class to find the correct Marketing Class.
                                </p>
                                <p style="text-align:left !important">
                                    5. Refer to the (i) icon under Service to find the correct Service Type.
                                </p>
                                <p style="text-align:left !important">
                                    6. For MLD and MLFS services, add the prefix “MLD-” before the Service Type.<br />
                                    <i>Example: </i><b>MLD-HARDWARE</b>
                                </p>
                            </span>
                        </button>
                    </div>
                    <div class="pull-left search-single">
                        <button id="sample_editable_1_new" class="tooltip" style="background: none; border: none; z-index: 11 !important; cursor: auto;">
                            <span class="class-service"><b>Class</b></span>
                            <span>
                                <i class="fa fa-info-circle" aria-hidden="true" style="color:#26327e !important;font-size: 35px;margin-top: 12px;"></i>
                            </span>
                            <span class="tooltiptext" style="top: 38px !important; color: white !important; background-color: #26327e !important; width: 300px !important; padding: 10px !important; display: block; max-height: 200px; overflow-y: auto;">
                                <table style="width: 100%;">
                                    <thead>
                                        <tr><th style="font-size: 20px;">Class List</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="class in vm.flatMarketingClassList" ng-class="{'category-title': class.isCategory}">
                                            <td style="text-align: left;">{{class.display}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </span>
                        </button>
                    </div>
                    <div class="pull-left search-single">
                        <button id="sample_editable_1_new" class="tooltip" style="background: none; border: none; z-index: 11 !important; cursor: auto;">
                            <span class="class-service"><b>Service</b></span>
                            <span>
                                <i class="fa fa-info-circle" aria-hidden="true" style="color:#26327e !important;font-size: 35px;margin-top: 12px;"></i>
                            </span>
                            <span class="tooltiptext" style="top: 38px !important; color: white !important; background-color: #26327e !important; width: 300px !important; padding: 10px !important; display: block; max-height: 200px; overflow-y: auto;">
                                <table style="width: 100%;">
                                    <thead>
                                        <tr><th style="font-size: 20px;">Service List</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="service in vm.flatServiceList" ng-class="{'category-title': service.isCategory}">
                                            <td style="text-align: left;">{{service.display}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </span>
                        </button>
                    </div>
                    <div class="pull-left search-single">
                        <div class="form-group form-md-line-input form-md-floating-label">
                            <select class="form-control input-small" id="search-option" ng-model="vm.searchOption"
                                    ng-change="vm.resetSeachOption()"
                                    ng-options="item.value as item.display for item in vm.searchOptions">
                                <option selected disabled hidden style='display: none' value=''></option>
                            </select>
                            <label for="search-option">Search Options</label>
                        </div>
                    </div>
                    <div class="pull-left search-single">
                        <div class="form-group form-md-line-input form-md-floating-label" ng-if="vm.isSuperAdmin == true && vm.searchOption == '1'">
                            <select class="form-control input-small" id="franchisee" ng-model="vm.query.franchiseeId"
                                    ng-change="vm.getBatchList();"
                                    ng-options="franchisee.value as franchisee.display for franchisee in vm.franchiseeCollection">
                                <option disabled value=''></option>
                            </select>
                            <label for="franchisee">Franchisee</label>
                        </div>
                    </div>
                    <div class="pull-left search-single">
                        <div class="form-group form-md-line-input form-md-floating-label" ng-if="vm.searchOption == '2'">
                            <select class="form-control input-small" id="franchisee" ng-model="vm.query.statusId"
                                    ng-change="vm.getBatchList();"
                                    ng-options="status.value as status.display for status in vm.uploadStatus">
                                <option disabled value=''></option>
                            </select>
                            <label for="franchisee">Status</label>
                        </div>
                    </div>
                    <div class="pull-left search-single" ng-if="vm.searchOption == '3'" style="margin-top: -13px !important;">
                        <div class="form-group form-md-line-input form-md-floating-label">
                            <input type="search" class="form-control input-sm" style="margin-top: 6px;" placeholder="" aria-controls="sample_1"
                                   ng-model="vm.query.text" key-stroke-action change="vm.getBatchList">
                            <label>Search</label>
                        </div>
                    </div>
                    <div class="pull-left search-single">
                        <div class="form-group form-md-line-input form-md-floating-label">
                            <input type="text" class="form-control input-small" id="date-range" date-range-picker change="vm.getBatchList"
                                   start-date="vm.query.periodStartDate" end-date="vm.query.periodEndDate">
                            <label for="date-range">Date Range</label>
                        </div>
                    </div>
                    <div class="pull-left search-single m-t-5">
                        <a class="btn btn-icon-only mbl" ng-click="vm.resetSearch();">
                            <i class="fa fa-remove"></i>
                        </a>
                    </div>
                    <div class="pull-left search-single m-t-5">
                        <a class="btn btn-icon-only mbl" ng-click="vm.refresh();">
                            <i class="fa fa-refresh"></i>
                        </a>
                    </div>
                    <div class="pull-left m-t-5 search-single">
                        <button id="sample_editable_1_new" ng-click="vm.uploadNewFile()" class="btn btn-primary">
                            Upload New
                        </button>
                    </div>
                    <div class="pull-left m-t-5 search-single">
                        <button id="sample_editable_1_new" ng-click="vm.downloadSampleFile()" class="btn btn-primary">
                            Download sample file
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="clearfix">
            <div class="pull-left">
                <div class="dataTables_info" id="sample_1_info" role="status" aria-live="polite" ng-if="vm.batchList.length > 0">
                    Showing
                    <span ng-if="(vm.query.pageNumber * vm.query.pageSize) <= vm.count">{{((vm.query.pageNumber - 1) * vm.query.pageSize)+ 1}} to {{vm.query.pageNumber * vm.query.pageSize}} of {{vm.count}} </span>
                    <span ng-if="(vm.query.pageNumber * vm.query.pageSize) > vm.count">{{((vm.query.pageNumber - 1) * vm.query.pageSize)+ 1}} to {{vm.count}} of {{vm.count}} </span>
                    records
                </div>
            </div>
            <div class="pull-right" ng-if="vm.batchList.length < vm.count">
                <div class="dataTables_paginate paging_bootstrap_full_number" id="sample_1_paginate">
                    <ul uib-pagination boundary-links="true" total-items="vm.count" ng-change="vm.pageChange()" items-per-page="vm.query.pageSize"
                        ng-model="vm.query.pageNumber" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" max-size="'5'"
                        last-text="&raquo;"></ul>
                </div>
            </div>
        </div>
        <div class="table-scrollable table-mbl">
            <div fix-height style="overflow: auto;">
                <table class="table table-striped table-bordered table-hover dataTable no-footer" id="sample_1" role="grid" aria-describedby="sample_1_info">
                    <thead fix-head>
                        <tr role="row">
                            <th class="sorting_disabled" style="width: 100px; min-width: 100px; max-width: 100px;" tabindex="0" aria-controls="sample_1"></th>
                            <th ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.Id,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.Id,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.Id }"
                                tabindex="0" aria-controls="sample_1" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Id"
                                style="width: 50px; min-width: 50px; max-width: 50px;" ng-click="vm.sorting(vm.SortColumns.Id);">ID</th>
                            <th ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.Status,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.Status,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.Status }" style="width: 80px; min-width: 80px; max-width: 80px;"
                                tabindex="0" aria-controls="sample_1" ng-click="vm.sorting(vm.SortColumns.Status);">
                                Status
                            </th>
                            <th class="sorting_disabled" style="width: 120px; min-width: 120px; max-width: 120px;">Failed Records</th>
                            <th ng-if="vm.isSuperAdmin == true" ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.Franchisee,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.Franchisee,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.Franchisee }"
                                tabindex="0" aria-controls="sample_1" aria-sort="ascending" aria-label="Name"
                                style="width: 180px; min-width: 180px; max-width: 180px;" ng-click="vm.sorting(vm.SortColumns.Franchisee);">
                                Franchisee
                            </th>
                            <th ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.UploadedDate,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.UploadedDate,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.UploadedDate }"
                                tabindex="0" aria-controls="sample_1" aria-sort="ascending"
                                aria-label="Name" ng-click="vm.sorting(vm.SortColumns.UploadedDate);" style="width: 120px; min-width: 120px; max-width: 120px;">
                                Uploaded On
                            </th>
                            <th ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.StartDate,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.StartDate,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.StartDate }"
                                tabindex="0" aria-controls="sample_1" aria-sort="ascending"
                                aria-label="Name" ng-click="vm.sorting(vm.SortColumns.StartDate);" style="width: 120px; min-width: 120px; max-width: 120px;">
                                Start Date
                            </th>
                            <th ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.EndDate,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.EndDate,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.EndDate}"
                                tabindex="0" aria-controls="sample_1" aria-sort="ascending" aria-label="Name" style="width: 100px; min-width: 100px; max-width: 100px;"
                                ng-click="vm.sorting(vm.SortColumns.EndDate);">
                                End Date
                            </th>
                            <th ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.Frequency,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.Frequency,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.Frequency }"
                                aria-label="Email" style="width: 80px; min-width: 80px; max-width: 80px;"
                                ng-click="vm.sorting(vm.SortColumns.Frequency);">
                                Frequency
                            </th>
                            <!--<th ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.TotalAmount,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.TotalAmount,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.TotalAmount }"
                                aria-label="TotalAmount" ng-click="vm.sorting(vm.SortColumns.TotalAmount);" style="width: 110px; min-width: 110px; max-width: 110px;">
                                Total Sales
                            </th>-->
                            <th aria-label="TotalAmount" style="width: 110px; min-width: 110px; max-width: 110px;">
                                Total Credit
                            </th>
                            <th aria-label="TotalAmount" style="width: 110px; min-width: 110px; max-width: 110px;">
                                Total Debit
                            </th>
                            <th ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.PaidAmount,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.PaidAmount,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.PaidAmount }"
                                aria-label="PaidAmount" ng-click="vm.sorting(vm.SortColumns.PaidAmount);" style="width: 130px; min-width: 130px; max-width: 130px;">
                                Total Sales(Cash)
                            </th>
                            <th ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.Customers,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.Customers,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.Customers }"
                                aria-label="Customers" ng-click="vm.sorting('Customers');" style="width: 80px; min-width: 80px; max-width: 80px;">
                                Customers
                            </th>
                            <th ng-class="{'sorting_desc': vm.query.sort.order == 1 && vm.query.sort.propName == vm.SortColumns.Invoices,
                                                        'sorting_asc' : vm.query.sort.order == 0  && vm.query.sort.propName == vm.SortColumns.Invoices,
                                                        'sorting': vm.query.sort.propName != vm.SortColumns.Invoices }" style="width: 80px; min-width: 80px; max-width: 80px;"
                                aria-label="Customers" ng-click="vm.sorting(vm.SortColumns.Invoices);">
                                Invoices
                            </th>
                            <th class="sorting_disabled" style="width: 150px; min-width: 150px; max-width: 150px;">Uploaded By</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="batch in vm.batchList">
                            <td style="width: 100px; min-width: 100px; max-width: 100px;">
                                <div class="btn-group pull-right">
                                    <button class="btn blue dropdown-toggle" data-toggle="dropdown">
                                        Action <i class="fa fa-angle-down"></i>
                                    </button>
                                    <ul class="dropdown-menu pull-right">
                                        <li>
                                            <a href="javascript:void(0);" ng-click="vm.downloadSalesData(batch.fileId)">Download file</a>
                                        </li>
                                        <li>
                                            <a ui-sref="core.layout.sales.list({ salesDataUploadId: batch.id, franchiseeId:batch.franchiseeId })">View Sales Data</a>
                                        </li>
                                        <li ng-if="batch.statusId != vm.BatchStatus.Uploaded">
                                            <a href="javascript:void(0);" ng-click="vm.getLogs(batch.logFileId)">View Logs</a>
                                        </li>
                                        <li ng-if="batch.statusId == vm.BatchStatus.Parsed">
                                            <a ui-sref="core.layout.sales.royalty({ salesDataUploadId: batch.id })">View Royalty Report</a>
                                        </li>
                                        <li ng-if="batch.statusId == vm.BatchStatus.Parsed">
                                            <a ui-sref="core.layout.sales.invoice({ salesDataUploadId: batch.id })">View Invoice</a>
                                        </li>
                                        <li ng-if="vm.isSuperAdmin == true">
                                            <a href="javascript:void(0);" ng-click="vm.showDetails(batch.id)">Delete</a>
                                        </li>
                                        <li ng-if="vm.isSuperAdmin == true">
                                            <a href="javascript:void(0);" ng-click="vm.reparse(batch.id)">Reparse</a>
                                        </li>
                                        <li ng-if="vm.isSuperAdmin == true">
                                            <a href="javascript:void(0);" ng-click="vm.updateBatch(batch)">Update</a>
                                        </li>
                                    </ul>
                                </div>
                            </td>
                            <td style="width: 50px; min-width: 50px; max-width: 50px;">{{batch.id}}</td>
                            <td style="width: 80px; min-width: 80px; max-width: 80px;">
                                <span class="label label-sm" ng-class="{ 'label-danger': batch.statusId == vm.BatchStatus.Failed,
                                  'label-success': batch.statusId == vm.BatchStatus.Parsed,
                                  'label-info': batch.statusId == vm.BatchStatus.Uploaded,
                                  'label-warning': batch.statusId == vm.BatchStatus.ParseInProgress }">{{batch.status}}</span>
                            </td>
                            <td style="width: 120px; min-width: 120px; max-width: 120px;">{{batch.failedRecords}}</td>
                            <td style="width: 180px; min-width: 180px; max-width: 180px;" ng-if="vm.isSuperAdmin == true"><a ng-click="vm.editFranchisee(batch.franchiseeId)">{{batch.franchiseeName}}</a></td>
                            <td style="width: 120px; min-width: 120px; max-width: 120px;">{{batch.uploadedOn | dateTimeFilter: 'd'}}</td>
                            <td style="width: 120px; min-width: 120px; max-width: 120px;">{{batch.periodStartDate |  dateTimeFilter}}</td>
                            <td style="width: 100px; min-width: 100px; max-width: 100px;">{{batch.periodEndDate |  dateTimeFilter}}</td>
                            <td style="width: 80px; min-width: 80px; max-width: 80px;">{{batch.frequency}}</td>
                            <!--<td style="width: 110px; min-width: 110px; max-width: 110px;">
                                <span ng-if="batch.totalAmount != null" currency-Exchange conversion-Rate="batch.currencyRate"
                                      input="batch.totalAmount" from-Currency="batch.currency">
                                </span>
                            </td>-->
                            <td style="width: 130px; min-width: 130px; max-width: 130px;">
                                <span ng-if="batch.totalCredit != null" currency-Exchange conversion-Rate="batch.currencyRate"
                                      input="batch.totalCredit" from-Currency="batch.currency">
                                </span>
                            </td>
                            <td style="width: 130px; min-width: 130px; max-width: 130px;">
                                <span ng-if="batch.totalDebit != null" currency-Exchange conversion-Rate="batch.currencyRate"
                                      input="batch.totalDebit" from-Currency="batch.currency">
                                </span>
                            </td>
                            <td style="width: 130px; min-width: 130px; max-width: 130px;">
                                <span ng-if="batch.paidAmount != null" currency-Exchange conversion-Rate="batch.currencyRate"
                                      input="batch.paidAmount" from-Currency="batch.currency">
                                </span>
                            </td>
                            <td style="width: 80px; min-width: 80px; max-width: 80px;">{{batch.numberOfCustomers}}</td>
                            <td style="width: 80px; min-width: 80px; max-width: 80px;">{{batch.numberOfInvoices}}</td>
                            <td style="width: 120px; min-width: 120px; max-width: 120px;">{{batch.failedRecords}}</td>
                            <td class="break_word" style="width: 150px; min-width: 150px; max-width: 150px;"><a href="mailto:{{batch.uploadedBy}}">{{batch.uploadedBy}}</a></td>

                        </tr>
                    </tbody>
                    <tr ng-if="vm.batchList.length == 0">
                        <td colspan="15" class="text-center"><span> No Records Found</span></td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="clearfix">
            <div class="pull-left">
                <div class="dataTables_info" id="sample_1_info" role="status" aria-live="polite" ng-if="vm.batchList.length > 0">
                    Showing
                    <span ng-if="(vm.query.pageNumber * vm.query.pageSize) <= vm.count">{{((vm.query.pageNumber - 1) * vm.query.pageSize)+ 1}} to {{vm.query.pageNumber * vm.query.pageSize}} of {{vm.count}} </span>
                    <span ng-if="(vm.query.pageNumber * vm.query.pageSize) > vm.count">{{((vm.query.pageNumber - 1) * vm.query.pageSize)+ 1}} to {{vm.count}} of {{vm.count}} </span>
                    records
                </div>
            </div>
            <div class="pull-right" ng-if="vm.batchList.length < vm.count">
                <div class="dataTables_paginate paging_bootstrap_full_number" id="sample_1_paginate">
                    <ul uib-pagination boundary-links="true" total-items="vm.count" ng-change="vm.pageChange()" items-per-page="vm.query.pageSize"
                        ng-model="vm.query.pageNumber" class="pagination-sm" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" max-size="'5'"
                        last-text="&raquo;"></ul>
                </div>
            </div>
        </div>
    </div>
</div>
